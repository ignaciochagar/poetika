<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: controllers/poem/poemController.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: controllers/poem/poemController.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import poemModel from "../../models/poemModel.js";

/**
 * @module /controllers/poem/poemController
 */


/**
 * Asynchronously retrieves all poems.
 *
 * @return {Object} An object containing the data array of poems
 */
async function getAll() {
    try {
        const poem = await poemModel.findAll();
        return { data: poem };
    }
    catch (error) {
        console.error(error);
        return { error: error };
    }
}

/**
 * Asynchronously retrieves a poem based on the provided ID.
 *
 * @param {number} id - The ID of the poem to retrieve
 * @return {Object} An object containing the retrieved poem data or an error object
 */
async function getById(id) {
    try {
        const poem = await poemModel.findByPk(id);
        if (!poem) {
            return { error: "El poema no existe" };
        }
        return { data: poem };
    }
    catch (error) {
        console.error(error);
        return { error };
    }
}


/**
 * Asynchronously creates a new poem based on the provided poemData.
 *
 * @param {Object} poemData - The data of the poem to be created
 * @return {Object} An object containing the data of the newly created poem
 */
async function create(poemData) {
    try {
        const newPoem = await poemModel.create(poemData);
        console.log("new poem",newPoem);
        return {data:newPoem};
    } catch (error) {
        console.error(error);
        return {error}
    }
}

/**
 * Asynchronously updates a poem based on the provided ID, title, author, year of release, and author ID.
 *
 * @param {number} id - The ID of the poem to update
 * @param {Object} poemData - The data containing the updated title, author, year of release, and author ID
 * @return {Object} An object containing the updated poem data or an error object
 */
async function update(id, poemData) {
    try {
        const { title, author, year_release, author_id} = poemData;
        const poem  = await poemModel.findByPk(id);
        if (!poem) {
            return { error: "No se puede modificar un autor que no existe, txoripan!" };
        }
        if (title) {
            poem.title = title;
        }
        if (author) {
            poem.author = author;
        }
        if (year_release) {
            poem.year_release = year_release;
        }
        if (author_id) {
            poem.author_id = author_id;
        }
        const newPoem = await poemModel.update(poemData,
            {
                where: 
                {
                    poem_id:id
                }
            }
        );        
        return {data:newPoem};
    } catch (error) {
        console.error(error);
        return {error}
    }
   
}

/**
 * Asynchronously removes a poem based on the provided ID.
 *
 * @param {number} id - The ID of the poem to remove
 * @return {Object} An object containing the removed poem data
 */
async function remove(id) {
    try {
        const result = await poemModel.findByPk(id);
        await result.destroy();
        return {data:result};
    } catch (error) {
        console.error(error);
    }
    
}

export {
    getAll,
    getById,
    create,
    update,
    remove
};


export default {
    getAll,
    getById,
    create,
    update,
    remove
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-_controllers_author_authorApiController.html">/controllers/author/authorApiController</a></li><li><a href="module-_controllers_author_authorController.html">/controllers/author/authorController</a></li><li><a href="module-_controllers_author_authorViewController.html">/controllers/author/authorViewController</a></li><li><a href="module-_controllers_poem_poemApiController.html">/controllers/poem/poemApiController</a></li><li><a href="module-_controllers_poem_poemController.html">/controllers/poem/poemController</a></li><li><a href="module-_controllers_poem_poemViewController.html">/controllers/poem/poemViewController</a></li><li><a href="module-_controllers_role_roleApiController.html">/controllers/role/roleApiController</a></li><li><a href="module-_controllers_user_userApiController.html">/controllers/user/userApiController</a></li><li><a href="module-_controllers_user_userController.html">/controllers/user/userController</a></li><li><a href="module-_controllers_user_userViewController.html">/controllers/user/userViewController</a></li><li><a href="module-_middlewares_authMiddleware.html">/middlewares/authMiddleware</a></li><li><a href="module-_models_authorModel.html">/models/authorModel</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Thu May 16 2024 10:59:51 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
